<!-- Модальное окно подключения -->
<div id="conn_modal" class="modal-overlay" onclick="closeConnModal(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
            <h2 id="conn_form_title" class="flex m-0">
                <i data-lucide="plus-circle" class="text-accent icon-medium"></i>
                Добавить подключение
            </h2>
            <button class="btn-transparent p-2" onclick="closeConnModal()" title="Закрыть">
                <i data-lucide="x" class="icon-medium"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <input type="text" id="conn_name" placeholder="Название (например, OpenAI)">
                <input type="hidden" id="conn_provider">
                <div class="custom-dropdown" data-input-id="conn_provider">
                    <div class="dropdown-trigger">
                        <span class="selected-text">Выберите провайдера...</span>
                        <i data-lucide="chevron-down" class="dropdown-arrow icon-small text-secondary"></i>
                    </div>
                    <div class="dropdown-menu">
                        {% for key, val in providers.items() %}
                        <div class="dropdown-option" data-value="{{ key }}" data-url="{{ val.url }}">
                            {{ val.name }}
                        </div>
                        {% endfor %}
                        <div class="dropdown-option" data-value="custom">Другой (Custom)</div>
                    </div>
                </div>
                <input type="text" id="conn_model" placeholder="Модель (gpt-4o, anthropic/claude-3)">
                <input type="password" id="conn_key" placeholder="API Key">
                <input type="text" id="conn_url" placeholder="Base URL (optional)">

                <div class="form-actions mt-3">
                    <button id="conn_check_btn" onclick="checkCurrentConn()" class="btn-icon btn-icon-accent"
                        title="Проверить">
                        <i data-lucide="activity" class="icon-small"></i>
                    </button>
                    <div class="flex-grow-1"></div>
                    <button id="conn_cancel_btn" onclick="closeConnModal()" class="btn btn-outline">
                        Отмена
                    </button>
                    <button id="conn_submit_btn" onclick="addConn()" class="btn btn-primary">
                        Добавить
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>